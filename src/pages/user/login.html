<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>OAT | Tela De Login</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='stylesheet' type='text/css' media='screen' href='main.css'>
    <link rel="icon" href="/public/imagens/Group 209 (2).png" type="image/x-icon">
    <link rel="stylesheet" type="text/css" href="/src/styles/login.css">
    <link rel="stylesheet" type="text/css" href="/src/styles/mediaquery.css">
    <link rel="stylesheet" href="/src/styles/root.css">
    
    <!-- ‚úÖ ESTILOS PARA MENSAGENS -->
    <style>
        .message {
            padding: 12px 16px;
            border-radius: 8px;
            margin: 15px 0;
            font-weight: 500;
            text-align: center;
            display: none;
        }
        .message.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .message.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .message.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        .user-types-info {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            font-size: 0.9rem;
            color: #666;
            text-align: center;
        }
    </style>
</head>

<body base>

    <div class="navsuperior">
        <div class="logotipo">
            <img src="/public/imagens/logo_escoladigital.png" alt="">
        </div>
    </div>
     <div class="content-bg">
        <div class="gradient-top"></div>
        <div class="grain"></div>
    </div>

    <main>
        <section class="main-content">
            <article class="content-form">
                
                <h3>N√£o possui conta?
                    <a href="/src/pages/user/cadastro.html">Cadastrar-se</a>
                </h3>
                <form class="loginForm" id="login-Form">
                    <header class="cabecalho-form">
                        <h1>ACESSE E DIVIRTA-SE APRENDENDO</h1>
                    </header>
                    <div class="form-fields">
                        <div class="field">
                            <label for="email">E-mail</label>
                            <input type="email" name="email" id="email" required>
                        </div>
                        <div class="field">
                            <label for="password">Senha</label>
                            <input type="password" name="password" id="password" maxlength="30" class="password-input" required>
                            <img src="/public/imagens/visibility.png" alt="" class="icon show" id="toggleSenha">
                            <img src="/public//imagens/visibility_off.png" alt="" class="icon hide" id="toggleSenhaOff">
                        </div>

                        <!-- ‚úÖ MENSAGEM DE ERRO/SUCESSO (integrada) -->
                        <div id="loginError" class="message"></div>

                        <div class="field-button">
                            <button type="submit" id="loginButton">Entrar</button>
                        </div>
                    </div>
                    <footer class="link-google">
                        <p>Logar com</p>
                        <a href="#">
                            <img src="/public/imagens/google-logo.png" alt="">
                        </a>
                    </footer>
                </form>
                <br>
                <p style="text-align: center;">Esqueceu sua senha?
                    <a href="/src/pages/recuperarSenha.html">Recuperar</a>
                </p>

                <!-- ‚úÖ INFORMA√á√ÉO SOBRE TIPOS DE USU√ÅRIO -->
                <div class="user-types-info">
                    <p><strong>üë®‚Äçüè´ Professores & üë®‚Äçüíº Administradores:</strong> Use o login fornecido</p>
                    <p><strong>üéì Alunos:</strong> Fa√ßa cadastro ou use login se j√° tiver conta</p>
                </div>
            </article>
        </section>
    </main>

    <!-- ‚úÖ SCRIPTS CORRETOS - AJUSTE OS CAMINHOS! -->
    <script src="/backend-integration/js/api.js"></script>
    <script src="/backend-integration/js/auth.js"></script>
    <script src="/backend-integration/js/app.js"></script>

    <!-- SEUS SCRIPTS ORIGINAIS -->
    <script src="/src/scripts/login.js"></script>
    <script src="/src/scripts/global.js"></script>

    <!-- ‚úÖ SCRIPT DE INTEGRA√á√ÉO DO LOGIN -->
    <script>
        // Integra√ß√£o do seu formul√°rio com nossa API
        document.getElementById('login-Form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const loginButton = document.getElementById('loginButton');
            const errorDiv = document.getElementById('loginError');

            try {
                // Mostrar loading
                loginButton.disabled = true;
                loginButton.textContent = 'Entrando...';
                errorDiv.style.display = 'none';

                console.log('üîê Tentando login:', email);
                
                // Fazer login usando nossa API
                await Auth.login(email, password);
                
                // ‚úÖ Login bem-sucedido
                showLoginMessage('‚úÖ Login realizado com sucesso! Redirecionando...', 'success');
                
            } catch (error) {
                console.error('‚ùå Erro no login:', error);
                showLoginMessage('‚ùå ' + error.message, 'error');
                loginButton.disabled = false;
                loginButton.textContent = 'Entrar';
            }
        });

        // Fun√ß√£o para mostrar mensagens no SEU design
        function showLoginMessage(message, type) {
            const errorDiv = document.getElementById('loginError');
            errorDiv.textContent = message;
            errorDiv.className = `message ${type}`;
            errorDiv.style.display = 'block';

            // Auto-esconder mensagens de sucesso
            if (type === 'success') {
                setTimeout(() => {
                    errorDiv.style.display = 'none';
                }, 3000);
            }
        }

        // Verificar se j√° est√° logado
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof Auth !== 'undefined' && Auth.isAuthenticated()) {
                const user = Auth.getUser();
                showLoginMessage(`‚úÖ Voc√™ j√° est√° logado como ${user.name}. Redirecionando...`, 'success');
                setTimeout(() => {
                    Auth.redirectToDashboard(user.role);
                }, 2000);
            }
        });

        // ‚úÖ INTEGRAR SEU TOGGLE DE SENHA EXISTENTE
        // Seu c√≥digo original de mostrar/esconder senha continua funcionando
    </script>

</body>

</html>